# BIOS and UEFI
## UEFI（统一可扩展固件接口）和BIOS（基本输入输出系统）都是计算机启动时负责初始化硬件设备并加载操作系统的固件，但它们在多个方面存在区别。具体如下：
- **用户界面**：
    - **BIOS**：界面通常是基于文本的，以黑色背景加白色文字为主，操作方式主要依靠键盘，不够直观，操作相对繁琐。
    - **UEFI**：界面是图形化的，支持鼠标操作，类似操作系统的图形界面，界面更直观，用户体验更好。
- **启动速度**：
    - **BIOS**：启动速度较慢，它需要按照顺序逐一检测硬件设备，整个过程较为繁琐，启动时间较长。
    - **UEFI**：采用了并行处理技术，可同时对多个设备进行初始化，大大缩短了启动时间，能实现快速启动，通常启动速度比BIOS快很多。
- **硬盘支持**：
    - **BIOS**：只能支持基于MBR（主引导记录）的硬盘分区，无法识别容量超过2TB的硬盘，存在容量限制。
    - **UEFI**：支持基于GPT（GUID分区表）的硬盘分区，可管理超大容量硬盘，满足现代大容量存储需求，理论上支持最大容量可达18.7亿TB。
- **安全性**：
    - **BIOS**：安全性较低，缺乏现代的安全防护机制，容易受到恶意软件攻击，在启动过程中对可执行代码没有安全方面的考虑。
    - **UEFI**：引入了Secure Boot等安全机制，能够验证启动加载项的签名，防止恶意软件在启动过程中加载，提升了系统的安全性。
- **架构和设计**：
    - **BIOS**：基于16位架构，功能有限，扩展性差。其代码采用静态链接，增加硬件功能时较为困难。
    - **UEFI**：基于32位或64位架构，采用模块化设计，支持更多硬件设备和协议，扩展性更强。厂家可以编写符合UEFI标准的驱动来拓展其能力。
- **启动设备支持**：
    - **BIOS**：主要支持传统的硬盘、光盘等启动设备，对新类型设备支持有限。
    - **UEFI**：支持更多类型的启动设备，包括NVMe SSD、网络启动等，更适合现代多样化的硬件环境。
- **兼容性**：
    - **BIOS**：只能与传统操作系统（如Windows 7及更早版本）兼容，对于新操作系统和硬件的支持存在局限性。
    - **UEFI**：支持现代操作系统（如Windows 8及后续版本、Linux等），同时可以通过CSM（Compatibility Support Module）模块兼容传统操作系统，兼容性更好。


## Partition Table
###  MBR，主引导记录
- 起源：诞生于 1983 年，随 DOS 系统推出，是早期 PC 硬盘的标准分区格式。
- 核心结构：包含主引导代码、分区表（64 字节）和结束标志（55 AA），分区表直接存储在硬盘首个扇区（0 号扇区）。
- 最多 4 个主分区，或 3 个主分区 + 1 个扩展分区（扩展分区内可创建多个逻辑分区）。
- 依赖 BIOS 引导，启动时读取 0 号扇区的主引导代码。

### GPT（GUID 分区表）
- 起源：由 UEFI 论坛开发，2005 年随 Windows Vista 和 Mac OS X 10.4 首次普及，用于替代 MBR 的局限性。
- 核心结构：使用全局唯一标识符（GUID）标识分区，分区表存储在硬盘前端和后端（有备份），支持更大容量和更灵活的分区管理。
- 理论支持 128 个主分区（受操作系统限制，如 Windows 默认支持 128 个，Linux 无严格限制）。
- 需配合 UEFI 固件启动，引导文件存储在 EFI 系统分区（ESP）。


## Grub
- grub 将自己的启动条目注册到BIOS中, 提供地址例如 /boot/EFI/Boot/bootx64.efi, 这个类似MBR启动中的主引导记录.
- 通过uefi将控制权交给grub之后， 会去efi分区中读取grub.cfg. 配置文件，并执行. 而后通过配置文件启动kernel 将控制权交给kernel
- EFI分区必须是vfat格式， 方便识别
- /boot 目录主要是用来放内核文件以及initramfs 的， grub可以识别多种文件系统， 因此/boot可以是一些常见的文件系统格式
- 内核首先使用initramfs 做一些必要的初始化， 然后再将自己挂载到实际的根目录上，启动systemd 
